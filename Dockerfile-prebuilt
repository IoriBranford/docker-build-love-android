FROM ioribranford/build-love-android:11.4-env

ENV LOVE_VERSION        "9b9cc15813bfa9d3a4b3ef2bb32fa32492ec9275"
ENV LOVE_ANDROID_URL    https://github.com/love2d/love-android.git
ENV LOVE_ANDROID_DIR    /love-android

# clone repo
RUN git clone --recursive $LOVE_ANDROID_URL ${LOVE_ANDROID_DIR}
WORKDIR ${LOVE_ANDROID_DIR}
RUN git checkout $LOVE_VERSION

# build
RUN ./gradlew assemble bundle
COPY ./build.sh .

# to sign packages and zip debug symbols for the Play Store
COPY sign-releases.sh package-debug-symbols.sh app/build/

CMD ./build.sh
